package scripts;

import org.openqa.selenium.By;
import org.testng.annotations.Test;

import com.aventstack.extentreports.Status;

import generic.BaseTest;
import generic.Lib;
import pom.LoginPageTest;
import pom.MyAuditsPageTest;

public class AuditSignoffForSubAuditLevelFunctionalittyTest extends BaseTest {


	
	
	
	//Testing the Functionality of the Audit Execution page
		@Test(priority=1)
		public void Signoffing_The_AuditType_Test() throws InterruptedException
		{
			LoginPageTest l=new LoginPageTest(driver);

			MyAuditsPageTest MA = new MyAuditsPageTest(driver);

			parentTest = extent.createTest("Multiple Auditor Functionality Which is Mapped With General Groups Test", "Testing the Functionality of the GP Multiple Auditor test");
			chiledTest = parentTest.createNode("Signoffing The AuditType Test");

			System.out.println("Signoffing The AuditType Test");

	//		l.ClickProfileBTN(driver);

	//		l.ClickLogoutBTN();

			chiledTest.log(Status.INFO, "Entered Valid UserName and Valid Password");
			String un=Lib.getCellValue(XLPATH, "Login Credentials",52,0);
			l.setusername(un);

			String pw=Lib.getCellValue(XLPATH,"Login Credentials",52,1);
			l.setpassword(pw);

			//clicking on the Login Button
			l.ClickSigninBTN();
			chiledTest.log(Status.INFO, "Sigin Button is Clicked");

			//Verify Signed in Successfully Message is Displayed
			l.verifySignedInSuccessMsgIsDisplayed(driver);
			chiledTest.log(Status.INFO, "Signed in successfully. Success Message is Displayed");

			//Passing the Values to Select Audit type
			String SA = Lib.getCellValue(XLPATH, "SubAudit Level Scenarios", 3, 3);
			MA.SetSelectAuditType(SA);

			MA.ClickMatched();

			MA.ClickfirstAuditType(driver);

			//Changes by manthan starts
			
			//Review period displayed on auditee summary page
	//		MA.VerifyAuditReviewPeriodOnSummaryPageInAuditee();
	/*		
			MA.ClickNoBTN(driver);
			
			MA.SelectEvidencesTab();
			
			MA.ClickRemarksTab(driver);
			
			MA.SelectAddPAramTab();
			
			MA.SelectCheckpoitTab();
			
			MA.MoveToReexamineBTN();
			
			MA.SetEnterCommentsReexamine("Comments");
			
			MA.AddDigitalEvidenceAuditeeSignOff();
			Thread.sleep(2000);
			MA.ClickReExamineButton(driver);
			
			//upto here 
			
			
			
			//clicking on the Sign Off Audit Button
			MA.ClickSingOffAuditButton(driver);

			//verifying the Are you sure you want to sign off this audit ? Pop Up is Displayed
		//	MA.VerifyAreYouSureYouWantToSignOffThisAuditPopupIsDisplayed(driver);

			//Clicking on the Due date 
			MA.ClickDueDate();

			//Passing the values to due Date
			String DD3 = Lib.getCellValue(XLPATH, "My Audit Page", 3, 6);
			MA.SetDueDate(DD3,driver);

			//clicking on the OK Button
			MA.ClickOKBTN();

			System.out.println("******************************");  */
		}
	
	
		@Test(priority=3)
	public void SignOffStaticSubAudit1() throws InterruptedException {

		LoginPageTest l=new LoginPageTest(driver);

		MyAuditsPageTest MA = new MyAuditsPageTest(driver);
		chiledTest = parentTest.createNode("Signoffing the static audit type.");
		MA.ClickSecondAuditType();
		
		//clicking on the Sign Off Audit Button
		MA.ClickSingOffAuditButton(driver);

		//verifying the Are you sure you want to sign off this audit ? Pop Up is Displayed
	//	MA.VerifyAreYouSureYouWantToSignOffThisAuditPopupIsDisplayed(driver);

		//Clicking on the Due date 
		MA.ClickDueDate();

		//Passing the values to due Date
		String DD3 = Lib.getCellValue(XLPATH, "My Audit Page", 3, 6);
		MA.SetDueDate(DD3,driver);

		//clicking on the OK Button
		MA.ClickOKBTN();
	}
	
	@Test(priority=2)
	public void SignOffStaticSubAudit2() throws InterruptedException {
		LoginPageTest l=new LoginPageTest(driver);

		MyAuditsPageTest MA = new MyAuditsPageTest(driver);
		chiledTest = parentTest.createNode("Signoffing the static audit type.");
		MA.ClickfirstAuditType(driver);	
		
		MA.SelectNOAcceptanceBTN();
		
		
		MA.SelectEvidencesTab();
		
		MA.ClickRemarksTab(driver);
		
		MA.SelectAddPAramTab();
		
		MA.SelectCheckpoitTab();
		
		MA.MoveToReexamineBTN();
		
		MA.SetEnterCommentsReexamine("Comments");
		
		MA.AddDigitalEvidenceAuditeeSignOff();
		Thread.sleep(2000);
		MA.ClickReExamineButton(driver);
		
		//clicking on the Sign Off Audit Button
	    MA.ClickSingOffAuditButton(driver);
		
	   //clicking on the OK Button
	    MA.ClickOKBTN();
	}
	
	
	@Test(priority=4)
	public void SignOffGeneralAuditType() throws InterruptedException {
		MyAuditsPageTest MA = new MyAuditsPageTest(driver);
		chiledTest = parentTest.createNode("Signoffing the static audit type.");
		MA.ClickThirdAuditType();	
		
		MA.SelectNOAcceptanceBTN();
		
		
		MA.SelectEvidencesTab();
		
		MA.ClickRemarksTab(driver);
		
		MA.SelectAddPAramTab();
		
		MA.SelectCheckpoitTab();
		
		MA.MoveToReexamineBTN();
		
		MA.SetEnterCommentsReexamine("Comments");
		
		MA.AddDigitalEvidenceAuditeeSignOff();
		Thread.sleep(2000);
		MA.ClickReExamineButton(driver);
		
		//clicking on the Sign Off Audit Button
	    MA.ClickSingOffAuditButton(driver);
		
	   //clicking on the OK Button
	    MA.ClickOKBTN();
		
	}
	
	@Test(priority=5)
	public void SignOffGeneralAuditType1() throws InterruptedException {
		
		LoginPageTest l=new LoginPageTest(driver);

		MyAuditsPageTest MA = new MyAuditsPageTest(driver);
		chiledTest = parentTest.createNode("Signoffing the static audit type.");
		MA.ClickFourthAuditType();
		
		//clicking on the Sign Off Audit Button
		MA.ClickSingOffAuditButton(driver);

		//verifying the Are you sure you want to sign off this audit ? Pop Up is Displayed
	//	MA.VerifyAreYouSureYouWantToSignOffThisAuditPopupIsDisplayed(driver);

		//Clicking on the Due date 
		MA.ClickDueDate();

		//Passing the values to due Date
		String DD3 = Lib.getCellValue(XLPATH, "My Audit Page", 3, 6);
		MA.SetDueDate(DD3,driver);

		//clicking on the OK Button
		MA.ClickOKBTN();
		
		driver.findElement(By.xpath("//a[text()='Sign off Main Audit']")).click();
	}
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
}
