package scripts;

import org.openqa.selenium.support.ui.ExpectedConditions;
import org.openqa.selenium.support.ui.WebDriverWait;
import org.testng.annotations.Test;

import com.aventstack.extentreports.Status;

import generic.BaseTest;
import generic.Lib;
import pom.AuditSchedulePageTest;
import pom.ConfigureAuditPageTest;
import pom.LoginPageTest;
import pom.SelfSchedulePageTest;
import pom.TemplatesPageTest;

public class ScheduleUploadChangesFunctionalityTest extends BaseTest {

	@Test(priority=1)
	public void Schedule_Upload_Test() throws InterruptedException
	{
		LoginPageTest l=new LoginPageTest(driver);

		ConfigureAuditPageTest CA = new ConfigureAuditPageTest(driver);

		parentTest = extent.createTest("Audit Schedule Functionality Test", "Testing the functionality to Schedule Upload.");

		chiledTest = parentTest.createNode("User trying to upload invalid file format.");

		System.out.println("Schedule Upload Functionality Test");

		chiledTest.log(Status.INFO, "Entered Valid UserName and Valid Password");
		String un=Lib.getCellValue(XLPATH, "Login Credentials",3,0);
		l.setusername(un);

		String pw=Lib.getCellValue(XLPATH,"Login Credentials",3,1);
		l.setpassword(pw);

		//clicking on the Login Button
		l.ClickSigninBTN();
		chiledTest.log(Status.INFO, "Sigin Button is Clicked");

		//Verify Signed in Successfully Message is Displayed
		l.verifySignedInSuccessMsgIsDisplayed(driver);
		chiledTest.log(Status.INFO, "Signed in successfully. Success Message is Displayed");
		
		TemplatesPageTest TP = new TemplatesPageTest(driver);
		
		//clicking on the Scroll bar
		TP.ClickScrollBar(driver);
		
		//clicking on the System and Setting menu item
	//	TP.ClickSystemAndSettings(driver);
		TP.SelectSystemSettings();
		Thread.sleep(3000);
		//clicking on the Templates
	//	TP.ClickTemplates(driver);
		TP.SelectTemplate();
		
		
		//clicking on the Select Document Type
		TP.ClickSelectDocType();
		chiledTest.log(Status.INFO, "Select Schedule template from dropdown.");
		//passing the Values to Document Type
		String DT = Lib.getCellValue(XLPATH, "Template", 9, 0);
		TP.SetSelectDocumnetType(DT);
		
		TP.ClickMatched();
		
		//Uploading the Cluster Documents
		TP.UploadScheduleDocument();
		
		//Upload documents button is clicked
		TP.ClickUploadDocumentButton();
		chiledTest.log(Status.INFO, "Document upload failed error message.");
		//Verifying Document saved successfully message is displayed
	//	TP.VerifyDocumentSavedSuccessfullyMSGIsDisplayed(driver);
		

		System.out.println("**************************");
		
	}
	
	@Test(priority=2)
	public void UploadValidScheduleDoc() throws InterruptedException {
		
		TemplatesPageTest TP = new TemplatesPageTest(driver);
		chiledTest = parentTest.createNode("User trying to upload valid file format.");
		//clicking on the Select Document Type
		TP.ClickSelectDocType();
		Thread.sleep(3000);	
		//passing the Values to Document Type
		String DT = Lib.getCellValue(XLPATH, "Template", 9, 0);
		TP.SetSelectDocumnetType(DT);
		Thread.sleep(3000);	
		chiledTest.log(Status.INFO, "Select Schedule template from dropdown.");		
		TP.ClickMatched();
		Thread.sleep(3000);		
		//Uploading the Cluster Documents
		TP.UploadCorrectScheduleDocument();
		Thread.sleep(3000);		
		//Upload documents button is clicked
		TP.ClickUploadDocumentButton();
		chiledTest.log(Status.INFO, "Document upload is in progress and will be completed in a short time pop up message.");
		
		
	}
	
	@Test(priority=3)
	public void SmartSearch() throws InterruptedException {
		TemplatesPageTest TP = new TemplatesPageTest(driver);
		chiledTest = parentTest.createNode("user clicks on the smart search field.");
		TP.SetSmartSearch("schedule_Upload");
		chiledTest.log(Status.INFO, "user should be allowed to enter input by Document name and get results.");
	}
	
	@Test(priority=4)
	public void UploadScheduelThroghSchedulModule() throws InterruptedException {
		AuditSchedulePageTest SP = new AuditSchedulePageTest(driver);
		SelfSchedulePageTest SC=new SelfSchedulePageTest(driver);
		LoginPageTest l=new LoginPageTest(driver);
		TemplatesPageTest TP = new TemplatesPageTest(driver);
		chiledTest = parentTest.createNode("Schedule module in the side menu, and then selects the Schedule Upload submodule.");

		//System.out.println("Creating GP Multiple Auditor Schedule Test");

		l.ClickProfileBTN(driver);

		l.ClickLogoutBTN();

		chiledTest.log(Status.INFO, "Entered Valid UserName and Valid Password");
		String un=Lib.getCellValue(XLPATH, "Login Credentials",3,0);
		l.setusername(un);

		String pw=Lib.getCellValue(XLPATH,"Login Credentials",3,1);
		l.setpassword(pw);

		//clicking on the Login Button
		l.ClickSigninBTN();
		chiledTest.log(Status.INFO, "Sigin Button is Clicked");

		//Verify Signed in Successfully Message is Displayed
		l.verifySignedInSuccessMsgIsDisplayed(driver);
		chiledTest.log(Status.INFO, "Signed in successfully. Success Message is Displayed");

		SP.ClickScrollBar(driver);

		//Clicking on the Schedule 
		SP.ClickSchedule(driver);	
		
		TP.SelectScheduleUpload();
		chiledTest.log(Status.INFO, "user clicks on Schedule upload in side menu.");
		TP.UploadCorrectDocumentThroughScheduleModule();
		
		TP.SetSmartSearch("schedule_Upload_Temp");
		chiledTest.log(Status.INFO, " user chooses the file and click on the Upload Schedules Document button");
		TP.DeleteSceduleUploadDoc();
		chiledTest.log(Status.INFO, "User clicks on the Delete Icon under the Action column.");
		
		TP.DeleteDocOkBTN();
		chiledTest.log(Status.INFO, "User clicks on the OK button and deleted the document.");
	}
	
	
	
	
	
}
