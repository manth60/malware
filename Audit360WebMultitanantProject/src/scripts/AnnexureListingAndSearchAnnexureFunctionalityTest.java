package scripts;

import org.openqa.selenium.By;
import org.testng.annotations.Test;

import com.aventstack.extentreports.Status;

import generic.BaseTest;
import generic.Lib;
import pom.LoginPageTest;
import pom.UploadAnnexureDocumentPageTest;

public class AnnexureListingAndSearchAnnexureFunctionalityTest extends BaseTest {

	
	//Testing the Functionality of the Uploading Annexure Document for Audit Type
		@Test(priority=1)
		public void Uploading_Annexure_Documenet_Test() throws InterruptedException
		{

			LoginPageTest l=new LoginPageTest(driver);

			UploadAnnexureDocumentPageTest UA = new UploadAnnexureDocumentPageTest(driver);
			parentTest = extent.createTest("Provisional Submission and Bulk Finalization Functionality Test", "Testing the Functionality of the Provisional submission, Bulk Finalization, and Do you need annexure sampling Functionality");
			chiledTest = parentTest.createNode("Uploading Annexure Document Test");

			System.out.println("Uploading Annexure Documenet Test");

			System.out.println("*********Uploading the Annexure Document for Static Annexure*******************");

			chiledTest.log(Status.INFO, "*********Uploading the Annexure Document for Static Annexure*******************");

			chiledTest.log(Status.INFO, "Entered Valid UserName and Valid Password");

		//	l.ClickProfileBTN(driver);

		//	l.ClickLogoutBTN();

			//Taking the User name from 'TestValidLoginPage' sheet in excel
			String un=Lib.getCellValue(XLPATH, "Login Credentials",3,0);
			String pw=Lib.getCellValue(XLPATH,"Login Credentials",3,1);

			l.setusername(un);

			l.setpassword(pw);

			//clicking on the Login Button
			l.ClickSigninBTN();
			chiledTest.log(Status.INFO, "Sigin Button is Clicked");

			//Verify Signed in Successfully Message is Displayed
			l.verifySignedInSuccessMsgIsDisplayed(driver);
			chiledTest.log(Status.INFO, "Signed in successfully. Success Message is Displayed");

			UA.ClickScrollBar(driver);

			UA.ClickAnnexure(driver);
			chiledTest.log(Status.INFO, "Annecxure is Clicked");

			UA.ClickAnnexureDocuments(driver);
			chiledTest.log(Status.INFO, "Annecxure Documents is Clicked");

			//Clicking on the Upload Annexure Button
			UA.ClickUploadAnnexureBTN(driver);
			chiledTest.log(Status.INFO, "Annecxure Documents Button is Clicked");

			//Clicking on the Audit Type
			UA.ClickAuditType();

			//Passing the Values to Audit Type
			String SA = Lib.getCellValue(XLPATH, "Configure Audit Type", 221, 0);
			UA.SetAuditType(SA);
			chiledTest.log(Status.INFO, "Audit Type is Selected");

			//Clicking on the Matched
			UA.ClickMatched();

			//Clicking on the Sub Audit Type
			UA.ClickSAT(driver);

			Thread.sleep(1000);
			driver.findElement(By.xpath("//select[@id='sub_audit_types']/option[contains(text(),'Static Annexure SAT')]")).click();

			//Clicking on the Annexure
			UA.ClickAnnexure1(driver);

			Thread.sleep(1000);
			//Selecting 1st option under Sub Audit type
			driver.findElement(By.xpath("//ul[@class='select2-results']/li[1]/div")).click();

			//Checking the Annexure Type Text
			UA.VerifyStaticAnnexureTypeIsDisplayed();

			//Uploading Documnets
			UA.UploadDocument();
			chiledTest.log(Status.INFO, "Document is Uploaded");

			//Clicking on the submit Button
			UA.ClickSubmitBTN(driver);
			chiledTest.log(Status.INFO, "Submit Button is Clicked");

			//Verifying Document Uploaded Successfully Message is Displayed 
		//	UA.VerifyDocumentUploadedSuccessfully(driver);
			chiledTest.log(Status.INFO, "Document Uploaded Successfully Message is Displayed");

			System.out.println("*********Uploading the Annexure Document for Dyanamic Annexure*******************");

			chiledTest.log(Status.INFO, "*********Uploading the Annexure Document for Dyanamic Annexure*******************");

			//Clicking on the Upload Annexure Button
			UA.ClickUploadAnnexureBTN(driver);
			chiledTest.log(Status.INFO, "Annecxure Documents Button is Clicked");

			//Clicking on the Audit Type
			UA.ClickAuditType();

			//Passing the Values to Audit Type
			String SA1 = Lib.getCellValue(XLPATH, "Configure Audit Type", 221, 0);
			UA.SetAuditType(SA1);
			chiledTest.log(Status.INFO, "Audit Type is Selected");

			//Clicking on the Matched
			UA.ClickMatched();

			//Clicking on the Sub Audit Type
			UA.ClickSAT(driver);

			Thread.sleep(1000);
			driver.findElement(By.xpath("//select[@id='sub_audit_types']/option[contains(text(),'Dynamic Annexure SAT')]")).click();

			//Clicking on the Annexure
			UA.ClickAnnexure1(driver);

			Thread.sleep(1000);
			//Selecting 1st option under Sub Audit type
			driver.findElement(By.xpath("//ul[@class='select2-results']/li[1]/div")).click();

			//Checking the Annexure Type Text
			UA.VerifyDynamicAnnexureTypeIsDisplayed();

			//Passing the values to From Date
			String FD = Lib.getCellValue(XLPATH, "Annexure Documents", 3, 0);
			UA.SetFromDate(FD, driver);
			chiledTest.log(Status.INFO, "From Date is Entered");

			//Passing the values to From Date
			String TD = Lib.getCellValue(XLPATH, "Annexure Documents", 4, 0);
			UA.SetToDate(TD, driver);
			chiledTest.log(Status.INFO, "TO Date is Entered");

			//Uploading Documents
			UA.UploadDocument();
			chiledTest.log(Status.INFO, "Document is Uploaded");

			//Clicking on the submit Button
			UA.ClickSubmitBTN(driver);
			chiledTest.log(Status.INFO, "Submit Button is Clicked");

			//Verifying Document Uploaded Successfully Message is Displayed 
		//	UA.VerifyDocumentUploadedSuccessfully(driver);
			chiledTest.log(Status.INFO, "Document Uploaded Successfully Message is Displayed");

			System.out.println("*************************************************************************");

			//invalid data in audit type dropdown[New changes]
			//Clicking on the Upload Annexure Button
			UA.ClickUploadAnnexureBTN(driver);
			chiledTest.log(Status.INFO, "Annecxure Documents Button is Clicked");

			//Clicking on the Audit Type
			UA.ClickAuditType();

			//Passing the Values to Audit Type
			String SA2 = Lib.getCellValue(XLPATH, "Configure Audit Type", 207, 0);
			UA.SetAuditType(SA2);
			chiledTest.log(Status.INFO, "Audit Type is Selected");

			//Clicking on the Matched
			//UA.ClickMatched();

			//Clicking on the Sub Audit Type
		//	UA.ClickSAT(driver);

		//	Thread.sleep(1000);
		//	driver.findElement(By.xpath("//select[@id='sub_audit_types']/option[contains(text(),'Static Annexure SAT')]")).click();

			//Clicking on the Annexure
		//	UA.ClickAnnexure1(driver);

			Thread.sleep(1000);
			//Selecting 1st option under Sub Audit type
		//	driver.findElement(By.xpath("//ul[@class='select2-results']/li[1]/div")).click();

			//Checking the Annexure Type Text
		//	UA.VerifyStaticAnnexureTypeIsDisplayed();

			//Uploading Documnets
			UA.UploadDocument();
			chiledTest.log(Status.INFO, "Document is Uploaded");

			//Clicking on the submit Button
			UA.ClickSubmitBTN(driver);
			chiledTest.log(Status.INFO, "Submit Button is Clicked");

			
			
			
			
			
			
			
			
			
			
		}

	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
}
